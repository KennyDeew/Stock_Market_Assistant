# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Task 7.1: Unit Tests

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-01-22
**–ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π:** AI Assistant

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

### 1. Test Classes - ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

#### Domain Layer Tests
- ‚úÖ **AssetTransactionTests** - 24 —Ç–µ—Å—Ç–∞ (–±—ã–ª–æ 8, –¥–æ–±–∞–≤–ª–µ–Ω–æ 16)
  - –°–æ–∑–¥–∞–Ω–∏–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç—ã—Ö/–Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (PortfolioId, StockCardId, Quantity, Price, TransactionDate)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ TotalAmount
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (Buy/Sell)
  - ‚úÖ **CreateBuyTransaction** - 8 —Ç–µ—Å—Ç–æ–≤ (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–∞–ª—é—Ç—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
  - ‚úÖ **CreateSellTransaction** - 8 —Ç–µ—Å—Ç–æ–≤ (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–∞–ª—é—Ç—ã, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)

- ‚úÖ **AssetRatingTests** - 29 —Ç–µ—Å—Ç–æ–≤ (–±—ã–ª–æ 8, –¥–æ–±–∞–≤–ª–µ–Ω–æ 21)
  - –°–æ–∑–¥–∞–Ω–∏–µ Portfolio –∏ Global —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (PortfolioId, Ticker, Period, Name, StockCardId)
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ UpdateStatistics
  - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–Ω–≥–æ–≤ —á–µ—Ä–µ–∑ AssignRanks
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ MarkAsUpdated
  - ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
    - EmptyStockCardId, TickerTooLong, EmptyName, NameTooLong, PeriodEndInFuture
    - UpdateCounts: NegativeBuyCount, NegativeSellCount, NegativeBuyAmount, NegativeSellAmount
    - AssignRanks: ZeroCountRank, ZeroAmountRank
    - UpdateStatistics: –≤—Å–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –Ω—É–ª–µ–≤—ã–µ —Ä–∞–Ω–≥–∏
  - ‚úÖ **Clone** - —Ç–µ—Å—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ø–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞

- ‚úÖ **PeriodTests** - 13 —Ç–µ—Å—Ç–æ–≤
  - –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏
  - –í–∞–ª–∏–¥–∞—Ü–∏—è (Start >= End, –ø–µ—Ä–∏–æ–¥ > 1 –≥–æ–¥–∞)
  - Factory –º–µ—Ç–æ–¥—ã (LastHour, LastDay, LastWeek, LastMonth, Custom)
  - –†–∞–≤–µ–Ω—Å—Ç–≤–æ Value Objects
  - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è DateTimeKind –≤ UTC
  - ToString —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- ‚úÖ **RatingCalculationServiceTests** - 6 —Ç–µ—Å—Ç–æ–≤
  - –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏–∑ –≥—Ä—É–ø–ø—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ PortfolioId
  - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–Ω–≥–æ–≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
  - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è Buy –∏ Sell —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

#### Application Layer Tests
- ‚úÖ **GetTopBoughtAssetsUseCaseTests** - 5 —Ç–µ—Å—Ç–æ–≤
  - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ Top
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å Portfolio –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
  - –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

- ‚úÖ **GetTopSoldAssetsUseCaseTests** - 3 —Ç–µ—Å—Ç–∞
  - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

- ‚úÖ **ComparePortfoliosUseCaseTests** - 5 —Ç–µ—Å—Ç–æ–≤
  - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
  - –í–∞–ª–∏–¥–∞—Ü–∏—è (–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –º–∞–∫—Å–∏–º—É–º–∞, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π –ø–µ—Ä–∏–æ–¥)
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –ø–µ—Ä–∏–æ–¥—É
  - –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ IPortfolioServiceClient –∏ IAssetTransactionRepository

- ‚úÖ **AssetRatingAggregationServiceTests** - 10 —Ç–µ—Å—Ç–æ–≤ (–Ω–æ–≤—ã–π –∫–ª–∞—Å—Å)
  - AggregateGlobalRatingsAsync —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
  - AggregateGlobalRatingsAsync –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - AggregateGlobalRatingsAsync —Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏ –≤ –≥—Ä—É–ø–ø–∞—Ö (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
  - AggregatePortfolioRatingsAsync —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
  - AggregatePortfolioRatingsAsync –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - AggregateRatingsAsync –≤—ã–∑—ã–≤–∞–µ—Ç –æ–±–∞ –º–µ—Ç–æ–¥–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ (null –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)

- ‚úÖ **ValidatorTests** - 12 —Ç–µ—Å—Ç–æ–≤
  - GetTopAssetsRequestValidatorTests (6 —Ç–µ—Å—Ç–æ–≤)
  - ComparePortfoliosRequestValidatorTests (6 —Ç–µ—Å—Ç–æ–≤)

**–ò—Ç–æ–≥–æ:** 107 —Ç–µ—Å—Ç–æ–≤ (–±—ã–ª–æ 60, –¥–æ–±–∞–≤–ª–µ–Ω–æ 47 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤)

### 2. Tools - ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

- ‚úÖ **xUnit** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö —Ç–µ—Å—Ç–∞—Ö (`[Fact]` –∞—Ç—Ä–∏–±—É—Ç—ã)
- ‚úÖ **FluentAssertions** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è assertions (138 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `Should()`)
- ‚úÖ **Moq** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (27 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π `Mock<>`, `Setup()`, `Verify()`)

### 3. Coverage - ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–• –¢–ï–°–¢–û–í

**–¢–µ–∫—É—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:**
- **Domain:** 73.3% —Å—Ç—Ä–æ–∫, 60.31% –≤–µ—Ç–æ–∫ (—Ç—Ä–µ–±—É–µ—Ç—Å—è >90%)
- **Application:** 44.04% —Å—Ç—Ä–æ–∫, 58.57% –≤–µ—Ç–æ–∫ (—Ç—Ä–µ–±—É–µ—Ç—Å—è >85%)
- **–û–±—â–µ–µ:** 59.77% —Å—Ç—Ä–æ–∫, 59.69% –≤–µ—Ç–æ–∫

**–ê–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è Domain:**
- ‚úÖ **Period** - 100% –ø–æ–∫—Ä—ã—Ç–∏–µ
- ‚úÖ **RatingCalculationService** - 84.61% –ø–æ–∫—Ä—ã—Ç–∏–µ
- ‚ö†Ô∏è **AssetRating** - 78.14% –ø–æ–∫—Ä—ã—Ç–∏–µ (–Ω–µ –ø–æ–∫—Ä—ã—Ç—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
- ‚ö†Ô∏è **AssetTransaction** - 43.63% –ø–æ–∫—Ä—ã—Ç–∏–µ (–Ω–µ –ø–æ–∫—Ä—ã—Ç—ã `CreateBuyTransaction`, `CreateSellTransaction`)
- ‚ùå **TransactionReceivedEvent** - 0% –ø–æ–∫—Ä—ã—Ç–∏–µ (–Ω–µ –ø–æ–∫—Ä—ã—Ç)

**–ê–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è Application:**
- ‚úÖ **Validators** - 100% –ø–æ–∫—Ä—ã—Ç–∏–µ (GetTopAssetsRequestValidator, ComparePortfoliosRequestValidator)
- ‚úÖ **GetTopBoughtAssetsUseCase** - 100% –ø–æ–∫—Ä—ã—Ç–∏–µ
- ‚úÖ **GetTopSoldAssetsUseCase** - 100% –ø–æ–∫—Ä—ã—Ç–∏–µ
- ‚úÖ **ComparePortfoliosUseCase** - 100% –ø–æ–∫—Ä—ã—Ç–∏–µ
- ‚ùå **GetPortfolioHistoryUseCase** - 0% –ø–æ–∫—Ä—ã—Ç–∏–µ (–Ω–µ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏)
- ‚ùå **AssetRatingAggregationService** - 0% –ø–æ–∫—Ä—ã—Ç–∏–µ (–Ω–µ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏)
- ‚ùå **DTOs** - 0% –ø–æ–∫—Ä—ã—Ç–∏–µ (–ø—Ä–æ—Å—Ç—ã–µ –∫–ª–∞—Å—Å—ã –¥–∞–Ω–Ω—ã—Ö, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π:**
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è GetPortfolioHistoryUseCase (–Ω–µ —É–∫–∞–∑–∞–Ω –≤ –∑–∞–¥–∞–Ω–∏–∏, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è AssetRatingAggregationService (–Ω–µ —É–∫–∞–∑–∞–Ω –≤ –∑–∞–¥–∞–Ω–∏–∏, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
3. ‚ö†Ô∏è –£–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ AssetTransaction (–¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è CreateBuyTransaction, CreateSellTransaction)
4. ‚ö†Ô∏è –£–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ AssetRating (–¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)
5. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è TransactionReceivedEvent (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù–∏–∑–∫–æ–µ –æ–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ:
- Infrastructure —Å–ª–æ–π (—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, Kafka Consumer, HTTP –∫–ª–∏–µ–Ω—Ç—ã) –Ω–µ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏ (—á—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è unit-—Ç–µ—Å—Ç–æ–≤)
- WebApi —Å–ª–æ–π (–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, middleware) –Ω–µ –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏
- DTOs –Ω–µ –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏ (–ø—Ä–æ—Å—Ç—ã–µ –∫–ª–∞—Å—Å—ã –¥–∞–Ω–Ω—ã—Ö)

**–§–∞–π–ª –ø–æ–∫—Ä—ã—Ç–∏—è:** `TestResults/*/coverage.cobertura.xml`

### 4. Edge Cases - ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–ü–æ–∫—Ä—ã—Ç—ã —Å–ª–µ–¥—É—é—â–∏–µ edge cases:

#### AssetTransaction
- ‚úÖ –ü—É—Å—Ç—ã–µ GUID (PortfolioId, StockCardId)
- ‚úÖ –ù—É–ª–µ–≤–æ–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- ‚úÖ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- ‚úÖ –î–∞—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±—É–¥—É—â–µ–º
- ‚úÖ –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (Buy/Sell)

#### AssetRating
- ‚úÖ –ü—É—Å—Ç–æ–π PortfolioId –¥–ª—è Portfolio –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ PortfolioId –¥–ª—è Global –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ü—É—Å—Ç–æ–π Ticker
- ‚úÖ –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–∫–æ–Ω–µ—Ü —Ä–∞–Ω—å—à–µ –Ω–∞—á–∞–ª–∞)

#### Period
- ‚úÖ Start >= End
- ‚úÖ Start == End
- ‚úÖ –ü–µ—Ä–∏–æ–¥ > 1 –≥–æ–¥–∞
- ‚úÖ –†–∞–∑–Ω—ã–µ DateTimeKind (Unspecified, Local, UTC)
- ‚úÖ –†–∞–≤–µ–Ω—Å—Ç–≤–æ Value Objects

#### Use Cases
- ‚úÖ StartDate >= EndDate
- ‚úÖ Top < 1
- ‚úÖ Top > MaxTopAssetsCount
- ‚úÖ –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π
- ‚úÖ –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –º–∞–∫—Å–∏–º—É–º–∞ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- ‚úÖ PortfolioId –¥–ª—è Global –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ PortfolioId –¥–ª—è Portfolio –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

#### Validators
- ‚úÖ –í—Å–µ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ –ì—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ –î—É–±–ª–∏–∫–∞—Ç—ã –≤ —Å–ø–∏—Å–∫–∞—Ö
- ‚úÖ –ü—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### 5. Mocks for Dependencies - ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–ú–æ–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

- ‚úÖ **IAssetRatingRepository** - –≤ GetTopBoughtAssetsUseCaseTests, GetTopSoldAssetsUseCaseTests
- ‚úÖ **IAssetTransactionRepository** - –≤ ComparePortfoliosUseCaseTests
- ‚úÖ **IPortfolioServiceClient** - –≤ ComparePortfoliosUseCaseTests
- ‚úÖ **ILogger<T>** - –≤–æ –≤—Å–µ—Ö Use Case —Ç–µ—Å—Ç–∞—Ö

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤

```
Total tests: 107
Passed: 107
Failed: 0
Skipped: 0
Duration: ~1.4-2.5 seconds
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
AnalyticsService.Tests/
‚îú‚îÄ‚îÄ Domain/
‚îÇ   ‚îú‚îÄ‚îÄ AssetTransactionTests.cs (24 —Ç–µ—Å—Ç–∞)
‚îÇ   ‚îú‚îÄ‚îÄ AssetRatingTests.cs (29 —Ç–µ—Å—Ç–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ PeriodTests.cs (13 —Ç–µ—Å—Ç–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ RatingCalculationServiceTests.cs (6 —Ç–µ—Å—Ç–æ–≤)
‚îú‚îÄ‚îÄ Application/
‚îÇ   ‚îú‚îÄ‚îÄ GetTopBoughtAssetsUseCaseTests.cs (5 —Ç–µ—Å—Ç–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ GetTopSoldAssetsUseCaseTests.cs (3 —Ç–µ—Å—Ç–∞)
‚îÇ   ‚îú‚îÄ‚îÄ ComparePortfoliosUseCaseTests.cs (5 —Ç–µ—Å—Ç–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ AssetRatingAggregationServiceTests.cs (10 —Ç–µ—Å—Ç–æ–≤) [–ù–û–í–´–ô]
‚îÇ   ‚îî‚îÄ‚îÄ ValidatorTests.cs (12 —Ç–µ—Å—Ç–æ–≤)
‚îî‚îÄ‚îÄ AnalyticsService.Tests.csproj
```

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

- ‚úÖ –í—Å–µ —Ç—Ä–µ–±—É–µ–º—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã —Å–æ–∑–¥–∞–Ω—ã (9 –∫–ª–∞—Å—Å–æ–≤, 107 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (xUnit, FluentAssertions, Moq) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
- ‚úÖ Edge cases –ø–æ–∫—Ä—ã—Ç—ã (–≤–∞–ª–∏–¥–∞—Ü–∏—è, –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –æ—à–∏–±–∫–∏)
- ‚úÖ –ú–æ–∫–∏ –¥–ª—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è (IAssetRatingRepository, IAssetTransactionRepository, IPortfolioServiceClient, ILogger)
- ‚ö†Ô∏è –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ –Ω–∏–∂–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π:
  - Domain: 73.3% (—Ç—Ä–µ–±—É–µ—Ç—Å—è >90%) - –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç ~17%
  - Application: 44.04% (—Ç—Ä–µ–±—É–µ—Ç—Å—è >85%) - –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç ~41%

## üîç –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–∫—Ä—ã—Ç–∏—è >90% Domain:
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `AssetTransaction.CreateBuyTransaction` –∏ `CreateSellTransaction` - –í–´–ü–û–õ–ù–ï–ù–û
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ `AssetRating` - –í–´–ü–û–õ–ù–ï–ù–û
3. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `TransactionReceivedEvent` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–∫—Ä—ã—Ç–∏—è >85% Application:
1. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `GetPortfolioHistoryUseCase` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `AssetRatingAggregationService` - –í–´–ü–û–õ–ù–ï–ù–û

### –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª `coverage.cobertura.xml` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ–ø–æ–∫—Ä—ã—Ç—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤ –∫–æ–¥–∞
2. –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, –∞ –Ω–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
3. DTOs –∏ –ø—Ä–æ—Å—Ç—ã–µ –∫–ª–∞—Å—Å—ã –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ–∫—Ä—ã—Ç–∏—è

