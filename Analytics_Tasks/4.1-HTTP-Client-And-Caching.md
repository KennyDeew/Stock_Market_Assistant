# Task 4.1: Implement PortfolioService HTTP Client with Caching

**Section:** Infrastructure Layer - HTTP Client  
**Priority:** Medium  
**Estimated Time:** 3-4 hours  
**Dependencies:** Task 5.2 (DTOs)

## Objective

Implement HTTP client for PortfolioService with retry, circuit breaker, and caching.

## Requirements

### IPortfolioServiceClient Interface

Define in `Application/Interfaces/IPortfolioServiceClient.cs`

### PortfolioServiceClient Implementation

Implement in `Infrastructure/Http/PortfolioServiceClient.cs`

**Features:**
- HTTP calls to PortfolioService
- Retry: 3 attempts, exponential backoff (Polly)
- Circuit breaker: 5 failures → 30s break
- Caching: GetHistoryAsync only (5 min TTL)
- Error handling: 404 → null, 503 → propagate

**Caching strategy:**
- ✅ GetHistoryAsync - cached (5 min)
- ❌ GetCurrentStateAsync - NOT cached
- ❌ GetMultipleStatesAsync - NOT cached

## Acceptance Criteria

- [ ] Interface in Application/Interfaces/
- [ ] Implementation in Infrastructure/Http/
- [ ] Polly policies configured
- [ ] Caching for history only
- [ ] Cache hit/miss logged
- [ ] Registered in DI

## File Structure

```
Application/Interfaces/IPortfolioServiceClient.cs
Infrastructure/Http/PortfolioServiceClient.cs
```