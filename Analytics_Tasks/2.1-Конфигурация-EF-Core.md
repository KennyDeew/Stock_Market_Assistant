# Задание 2.1: Конфигурация Entity Framework Core

**Раздел:** Infrastructure Layer - Database  
**Приоритет:** Высокий  
**Время:** 2-3 часа  
**Зависимости:** 1.1

## Цель

Настроить Entity Framework Core с PostgreSQL, создать DbContext и конфигурации сущностей.

## Требования

### AnalyticsDbContext

```csharp
public class AnalyticsDbContext : DbContext
{
    public DbSet<AssetTransaction> AssetTransactions { get; set; }
    public DbSet<AssetRating> AssetRatings { get; set; }
    
    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        modelBuilder.ApplyConfiguration(new AssetTransactionConfiguration());
        modelBuilder.ApplyConfiguration(new AssetRatingConfiguration());
    }
}
```

### Конфигурации

**AssetTransactionConfiguration:**
- Таблица: `asset_transactions`
- Precision: (18,8) для Quantity, (18,2) для Price/TotalAmount
- Индексы на: StockCardId, PortfolioId, TransactionDate, (StockCardId, TransactionDate)

**AssetRatingConfiguration:**
- Таблица: `asset_ratings`
- Precision: (18,2) для amounts
- Индексы на: StockCardId, (PeriodStart, PeriodEnd), (Context, PortfolioId)
- Unique constraint: (StockCardId, PeriodStart, PeriodEnd, Context) WHERE portfolio_id IS NULL

## Критерии приёмки

- [ ] AnalyticsDbContext в Infrastructure/Persistence/
- [ ] Конфигурации в Infrastructure/Persistence/Configurations/
- [ ] Все свойства корректно замаплены
- [ ] Snake_case для таблиц и колонок
- [ ] Индексы созданы
- [ ] DbContext зарегистрирован в DI

## Структура файлов

```
Infrastructure/
  Persistence/
    AnalyticsDbContext.cs
    Configurations/
      AssetTransactionConfiguration.cs
      AssetRatingConfiguration.cs
```
