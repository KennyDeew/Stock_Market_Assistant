# Задание 5.1: Application Services и Use Cases

**Раздел:** Application Layer  
**Приоритет:** Высокий  
**Время:** 4-5 часов  
**Зависимости:** 1.4, 2.2, 4.1

## Цель

Реализовать логику оркестрации.

## Компоненты

### AssetRatingAggregationService

Местоположение: `Application/Services/`

Оркестрирует агрегацию рейтингов.

**Методы:**
- AggregateRatingsAsync(Period period)
- AggregateGlobalRatingsAsync(...)
- AggregatePortfolioRatingsAsync(...)

### Use Cases

Местоположение: `Application/UseCases/`

**GetTopBoughtAssetsUseCase:**
- Валидация: startDate < endDate, top между 1-100
- Создание Period
- Вызов GetTopBoughtAsync()

**GetTopSoldAssetsUseCase:**
- Аналогично GetTopBoughtAssetsUseCase

**GetPortfolioHistoryUseCase:**
- Валидация дат
- Вызов IPortfolioServiceClient.GetHistoryAsync()

**ComparePortfoliosUseCase:**
- Валидация: макс 10 портфелей
- Получение данных от PortfolioService
- Получение транзакций из репозиториев
- Комбинирование данных

## Критерии приёмки

- [ ] AssetRatingAggregationService в Application/Services/
- [ ] Все Use Cases в Application/UseCases/
- [ ] Валидация входных данных
- [ ] Зарегистрированы в DI

## Структура

```
Application/
  Services/
    AssetRatingAggregationService.cs
  UseCases/
    GetTopBoughtAssetsUseCase.cs
    GetTopSoldAssetsUseCase.cs
    GetPortfolioHistoryUseCase.cs
    ComparePortfoliosUseCase.cs
```
