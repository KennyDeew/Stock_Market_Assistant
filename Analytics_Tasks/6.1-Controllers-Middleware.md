# Task 6.1: Implement API Controllers and Middleware

**Section:** WebApi Layer  
**Priority:** High  
**Estimated Time:** 3-4 hours  
**Dependencies:** Tasks 5.1, 5.2

## Objective

Implement REST API endpoints and global error handling.

## Components

### Controllers
Location: `WebApi/Controllers/`

**AssetAnalyticsController:**
- GET /api/analytics/assets/top-bought
- GET /api/analytics/assets/top-sold

**PortfolioAnalyticsController:**
- GET /api/analytics/portfolios/{id}/history
- POST /api/analytics/portfolios/compare

### Middleware
Location: `WebApi/Middleware/`
- GlobalExceptionMiddleware (error handling)

### Swagger
Configure OpenAPI documentation with JWT auth.

## Acceptance Criteria

- [ ] Controllers in WebApi/Controllers/
- [ ] [Authorize] attributes
- [ ] ProducesResponseType for Swagger
- [ ] Error handling middleware
- [ ] Swagger UI configured
- [ ] HTTP status codes correct